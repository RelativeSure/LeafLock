---
title: Development Guide
description: LeafLock development environment and build pipeline reference.
---

import { Tabs, TabItem, Card, CardGrid, Code } from '@astrojs/starlight/components';

## Workspace Setup

<Tabs>
  <TabItem label="Podman (default)">
    <Code
      code={`git clone https://github.com/RelativeSure/LeafLock.git
cd LeafLock
cp .env.example .env
make up
make logs`}
      language="bash"
    />
  </TabItem>
  <TabItem label="Docker Compose">
    <Code
      code={`git clone https://github.com/RelativeSure/LeafLock.git
cd LeafLock
cp .env.example .env
docker compose up -d
docker compose logs -f`}
      language="bash"
    />
  </TabItem>
</Tabs>

Shut everything down with `<Code code={`make down`} language="bash" />` or `docker compose down` when finished.

## Core Services

<CardGrid columns={2}>
  <Card title="Frontend" icon="laptop">
    Runs on Vite dev server at <Code code={`http://localhost:3000`} language="text" />. Proxies authenticated calls to the backend and hosts the client-side encryption pipeline.
  </Card>
  <Card title="Backend" icon="terminal">
    Go 1.23 service listening on <Code code={`http://localhost:8080`} language="text" /> with liveness at `/api/v1/health/live` and readiness at `/api/v1/health/ready`.
  </Card>
  <Card title="PostgreSQL" icon="database">
    Provisioned via container `postgres` with data volume `leaflock_postgres_data`. Schema is auto-created on boot; see `/reference/database-schema` for table definitions.
  </Card>
  <Card title="Redis" icon="cloud">
    Session cache and WebSocket coordination channel. Default URL is `redis://redis:6379/0` with password pulled from `.env`.
  </Card>
</CardGrid>

## Build Pipeline

### Backend

<Code
  code={`# Format and lint
make -C backend fmt
make -C backend vet

# Compile binary
make -C backend build

# Run backend tests with coverage
make -C backend test`}
  language="bash"
/>

Binary artifacts land in `backend/bin/leaflock`. The Makefile injects git metadata and enables race detection for test runs.

### Frontend

<Code
  code={`cd frontend
pnpm install
pnpm run dev
pnpm run build
pnpm run test`}
  language="bash"
/>

Production bundles emit to `frontend/dist` and are consumed by the Caddy image during container builds.

## Local Configuration

All environment variables are documented in `/reference/environment-variables`. For day-to-day work ensure the following are set:

<Code
  code={`POSTGRES_PASSWORD=<local-password>
REDIS_PASSWORD=<local-password>
JWT_SECRET=<64-char-secret>
SERVER_ENCRYPTION_KEY=<32-char-key>
CORS_ORIGINS=http://localhost:3000`}
  language="env"
/>

LeafLock enforces a zero-knowledge policy even locally, so password resets and key rotation rely on the same encryption workflows as production ðŸŽ¯.

## Hot Reload Architecture

- Backend uses `air` (configured in `backend/.air.toml`) to rebuild on change when running via `make dev`.
- Frontend Vite server performs HMR through WebSockets; keep `VITE_API_URL` unset to auto-target the Docker network.
- Database migrations run automatically; set `SKIP_MIGRATION_CHECK=true` only for targeted benchmarks.

## Quality Gates

<Code
  code={`# Full validation suite
make lint        # aggregates backend + frontend lint
make test        # backend unit and integration tests
pnpm --dir frontend test --runInBand # focused frontend run

# Static analysis
make -C backend security
pnpm --dir frontend run type-check`}
  language="bash"
/>

CI executes the same targets inside `.github/workflows/e2e-verify.yml` before publishing container images. Keep the pipeline green and updates sail through ðŸš€.

## Further Reading

- `/reference/api-reference` for endpoint semantics and request schemas
- `/reference/encryption-technical` for client cryptography internals
- `/deployment/` for platform-specific compose, Helm, and Railway recipes
